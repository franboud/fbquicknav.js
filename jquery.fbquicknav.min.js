(function(a){a.fn.fbquicknav=function(i){function t(i,t){var e=a("<div>",{class:"quickNav__items jsQuickNav__ctn"});t.each(function(i,t){var n=a(t),c=n.attr(f.section_title),r=a("<a>",{href:"#",class:"quickNav__item",html:a('<span class="quickNav__text">'+c+"</span>")});r.attr("data-quicknav-index",i),n.attr("data-quicknav-index",i),n.data("titre",c),e.append(r)});var n=i.attr("data-quicknav-main-title");if(void 0!==n){var c=a("<div>",{class:"quickNav__carrieres",html:n});i.append(c)}if(i.append(e),!0===f.add_trigger){var r=' <button type="button" class="quickNav__trigger jsQuickNav__trigger"><span class="quickNav__triggerLabel jsQuickNav__triggerLabel"></span><svg class="icon quickNav__triggerIcon quickNav__triggerOpen"><use xlink:href="#icon-arrow-down" /></svg><svg class="icon quickNav__triggerIcon quickNav__triggerClose"><use xlink:href="#icon-close" /></svg></button>';i.append(r)}}function e(i){if(!0===f.add_trigger){var t=a(".jsQuickNav__trigger",i),e=(a(".quickNav__item",i),a(".jsQuickNav__ctn",i));t.on("click",function(t){a(this);e.hasClass("on")?r(i):c(i),t.preventDefault()})}}function n(i){!0===f.add_trigger&&a(window).on("scroll",function(){q&&r(i)})}function c(i){var t=a(".jsQuickNav__trigger",i),e=a(".jsQuickNav__ctn",i);e.addClass("on"),t.addClass("on"),q=!0}function r(i){var t=a(".jsQuickNav__trigger",i),e=a(".jsQuickNav__ctn",i);e.removeClass("on"),t.removeClass("on"),q=!1}function s(i,t){i.on("click","a",function(i){i.preventDefault();var e=a(this),n=e.attr("data-quicknav-index"),c=t.filter("[data-quicknav-index='"+n+"']");o(c)})}function o(i){a.scrollTo(i,{offset:f.scroll_offset,duration:f.scroll_duration})}function l(i,t){if(!0===f.add_trigger){var e=a(".jsQuickNav__triggerLabel",i),n=t.data("titre");e.html(n)}}function v(i,t){var e=new ScrollMagic.Controller,n=a("a",i);t.each(function(t,c){var r=a(c),s=r.attr("data-quicknav-index"),o=r.attr("data-quicknav-on-dark"),v=r.attr("data-quicknav-main-title-show"),u=a("a[data-quicknav-index='"+s+"']",i);if(o=void 0!==o,v=void 0!==v,1==f.calculate_heights)var d=new ScrollMagic.Scene({triggerElement:c,triggerHook:.5,duration:k[s]}).on("enter",function(){r.data("active",1),u.addClass("active"),o&&i.addClass("onDarkSection"),v&&i.addClass("showTitleSection"),l(i,r)}).on("leave",function(){r.data("active",0),u.removeClass("active"),o&&i.removeClass("onDarkSection"),v&&i.removeClass("showTitleSection")}).addTo(e);else{d=new ScrollMagic.Scene;d.triggerElement(c).triggerHook(.5).on("start",function(t){if("FORWARD"==t.scrollDirection)n.removeClass("active"),u.addClass("active");else{n.removeClass("active");var e=s-1,c=a("a[data-quicknav-index='"+e+"']",i);c.addClass("active")}}).addTo(e)}h[s]=d})}function u(i){var t=a(f.section_class_hide);if(0!==t.length){var e=new ScrollMagic.Controller;new ScrollMagic.Scene({triggerElement:t[0],triggerHook:.7}).setClassToggle(i[0],"quickNav--hide").addTo(e)}}function d(i){!0===f.calculate_heights&&i.each(function(i,t){var e=a(t).outerHeight(!0);k[i]=e})}function g(a){a.each(function(a,i){h[a].duration(k[a])})}var f=a.extend({section_class:".jsQuickNav__section",section_class_hide:".jsQuickNav__hide",section_title:"data-quicknav-title",scroll_offset:-100,scroll_duration:500,add_trigger:!1,calculate_heights:!0},i),k=[],h=[],q=!1;return this.each(function(){var i=a(this),c=a(f.section_class+"["+f.section_title+"]");t(i,c),e(i),n(i),s(i,c),d(c),v(i,c),u(i),1==f.calculate_heights&&window.addEventListener("resize",_.debounce(function(){d(c),g(c)},300)),i.addClass("isInit")})}})(jQuery);