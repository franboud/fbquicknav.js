(function(n){n.fn.fbquicknav=function(a){function i(a,i){var t=n("<div>",{class:"quicknav__items jsQuicknav__ctn"});if(i.each(function(a,i){var e=n(this),c=e.attr(d.section_title),s=n("<a>",{href:"#",class:"quicknav__item",html:n('<span class="quicknav__text">'+c+"</span>")});s.attr("data-quicknav-index",a),e.attr("data-quicknav-index",a),t.append(s)}),a.append(t),!0===d.add_trigger){var e=' <button type="button" class="btn-icon quicknav__trigger jsQuicknav__trigger"><svg class="icon quicknav__triggeropen"><use xlink:href="#icon-main-menu" /></svg><svg class="icon quicknav__triggerclose"><use xlink:href="#icon-close" /></svg></button>';a.append(e)}}function t(a){if(!0===d.add_trigger){var i=n(".jsQuicknav__trigger",a),t=(n(".quicknav__item",a),n(".jsQuicknav__ctn",a));i.on("click",function(i){n(this);t.hasClass("on")?s(a):c(a),i.preventDefault()})}}function e(a){!0===d.add_trigger&&n(window).on("scroll",function(){k&&s(a)})}function c(a){var i=n(".jsQuicknav__trigger",a),t=n(".jsQuicknav__ctn",a);t.addClass("on"),i.addClass("on"),k=!0}function s(a){var i=n(".jsQuicknav__trigger",a),t=n(".jsQuicknav__ctn",a);t.removeClass("on"),i.removeClass("on"),k=!1}function o(a,i){a.on("click","a",function(a){a.preventDefault();var t=n(this),e=t.attr("data-quicknav-index"),c=i.filter("[data-quicknav-index='"+e+"']");n.scrollTo(c,{offset:d.scroll_offset,duration:d.scroll_duration})})}function r(a,i){var t=new ScrollMagic.Controller,e=n("a",a);i.each(function(i,c){var s=n(c),o=s.attr("data-quicknav-index"),r=n("a[data-quicknav-index='"+o+"']",a),l=r[0];if(1==d.calculate_heights)var u=new ScrollMagic.Scene({triggerElement:c,triggerHook:.5,duration:g[o]}).setClassToggle(l,"active").addTo(t);else{u=new ScrollMagic.Scene;u.triggerElement(c).triggerHook(.5).on("start",function(i){if("FORWARD"==i.scrollDirection)e.removeClass("active"),r.addClass("active");else{e.removeClass("active");var t=o-1,c=n("a[data-quicknav-index='"+t+"']",a);c.addClass("active")}}).addTo(t)}f[o]=u})}function l(a){var i=n(d.section_class_hide);if(0!==i.length){var t=new ScrollMagic.Controller;new ScrollMagic.Scene({triggerElement:i[0],triggerHook:.7}).setClassToggle(a[0],"quicknav--hide").addTo(t)}}function u(a){!0===d.calculate_heights&&a.each(function(a,i){var t=n(i).outerHeight(!0);g[a]=t})}function v(n){n.each(function(n,a){f[n].duration(g[n])})}var d=n.extend({section_class:".jsQuicknav__section",section_class_hide:".jsQuicknav__hide",section_title:"data-quicknav-title",scroll_offset:-100,scroll_duration:500,add_trigger:!1,calculate_heights:!1},a),g=[],f=[],k=!1;return this.each(function(){var a=n(this),c=n(d.section_class);i(a,c),t(a),e(a),o(a,c),u(c),r(a,c),l(a),1==d.calculate_heights&&window.addEventListener("resize",_.debounce(function(){u(c),v(c)},300)),a.addClass("isInit")})}})(jQuery);