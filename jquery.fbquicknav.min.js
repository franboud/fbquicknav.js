(function(a){a.fn.fbquicknav=function(i){function n(i,n){var t=a("<div>",{class:"quicknav__items jsQuicknav__ctn"});n.each(function(i,n){var e=a(n),c=e.attr(f.section_title),r=a("<a>",{href:"#",class:"quicknav__item",html:a('<span class="quicknav__text">'+c+"</span>")});r.attr("data-quicknav-index",i),e.attr("data-quicknav-index",i),e.data("titre",c),t.append(r)});var e=i.attr("data-quicknav-main-title");if(void 0!==e){var c=a("<div>",{class:"quicknav__carrieres",html:e});i.append(c)}if(i.append(t),!0===f.add_trigger){var r=' <button type="button" class="quicknav__trigger jsQuicknav__trigger"><span class="quicknav__triggerLabel jsQuicknav__triggerLabel"></span><svg class="icon quicknav__triggerIcon quicknav__triggerOpen"><use xlink:href="#icon-arrow-down" /></svg><svg class="icon quicknav__triggerIcon quicknav__triggerClose"><use xlink:href="#icon-close" /></svg></button>';i.append(r)}}function t(i){if(!0===f.add_trigger){var n=a(".jsQuicknav__trigger",i),t=(a(".quicknav__item",i),a(".jsQuicknav__ctn",i));n.on("click",function(n){a(this);t.hasClass("on")?r(i):c(i),n.preventDefault()})}}function e(i){!0===f.add_trigger&&a(window).on("scroll",function(){q&&r(i)})}function c(i){var n=a(".jsQuicknav__trigger",i),t=a(".jsQuicknav__ctn",i);t.addClass("on"),n.addClass("on"),q=!0}function r(i){var n=a(".jsQuicknav__trigger",i),t=a(".jsQuicknav__ctn",i);t.removeClass("on"),n.removeClass("on"),q=!1}function s(i,n){i.on("click","a",function(i){i.preventDefault();var t=a(this),e=t.attr("data-quicknav-index"),c=n.filter("[data-quicknav-index='"+e+"']");o(c)})}function o(i){a.scrollTo(i,{offset:f.scroll_offset,duration:f.scroll_duration})}function l(i,n){if(!0===f.add_trigger){var t=a(".jsQuicknav__triggerLabel",i),e=n.data("titre");t.html(e)}}function v(i,n){var t=new ScrollMagic.Controller,e=a("a",i);n.each(function(n,c){var r=a(c),s=r.attr("data-quicknav-index"),o=r.attr("data-quicknav-on-dark"),v=r.attr("data-quicknav-main-title-show"),u=a("a[data-quicknav-index='"+s+"']",i);if(o=void 0!==o,v=void 0!==v,1==f.calculate_heights)var d=new ScrollMagic.Scene({triggerElement:c,triggerHook:.5,duration:k[s]}).on("enter",function(){r.data("active",1),u.addClass("active"),o&&i.addClass("onDarkSection"),v&&i.addClass("showTitleSection"),l(i,r)}).on("leave",function(){r.data("active",0),u.removeClass("active"),o&&i.removeClass("onDarkSection"),v&&i.removeClass("showTitleSection")}).addTo(t);else{d=new ScrollMagic.Scene;d.triggerElement(c).triggerHook(.5).on("start",function(n){if("FORWARD"==n.scrollDirection)e.removeClass("active"),u.addClass("active");else{e.removeClass("active");var t=s-1,c=a("a[data-quicknav-index='"+t+"']",i);c.addClass("active")}}).addTo(t)}h[s]=d})}function u(i){var n=a(f.section_class_hide);if(0!==n.length){var t=new ScrollMagic.Controller;new ScrollMagic.Scene({triggerElement:n[0],triggerHook:.7}).setClassToggle(i[0],"quicknav--hide").addTo(t)}}function d(i){!0===f.calculate_heights&&i.each(function(i,n){var t=a(n).outerHeight(!0);k[i]=t})}function g(a){a.each(function(a,i){h[a].duration(k[a])})}var f=a.extend({section_class:".jsQuicknav__section",section_class_hide:".jsQuicknav__hide",section_title:"data-quicknav-title",scroll_offset:-100,scroll_duration:500,add_trigger:!1,calculate_heights:!0},i),k=[],h=[],q=!1;return this.each(function(){var i=a(this),c=a(f.section_class+"["+f.section_title+"]");n(i,c),t(i),e(i),s(i,c),d(c),v(i,c),u(i),1==f.calculate_heights&&window.addEventListener("resize",_.debounce(function(){d(c),g(c)},300)),i.addClass("isInit")})}})(jQuery);