"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}var FBQuickNav=function(){function FBQuickNav(selector){_classCallCheck(this,FBQuickNav),this.selector=selector,this.quicknavEl=document.querySelector(this.selector),null!=this.quicknavEl&&void 0!==this.quicknavEl&&(this.settings={section_class:".jsQuickNav__section",section_title:"data-quicknav-title",section_class_hide:".footer",scroll_offset:-120,add_trigger:!0,trigger_after_items:!1,trigger_icon_open:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M24 28.82l.75-.65 8.4-7.27-1.49-1.72L24 25.81l-7.66-6.63-1.49 1.72 8.4 7.27.75.65z"/></svg>',trigger_icon_close:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M34.53 34.4l-.09.1a1.11 1.11 0 01-1.82 0L24 25.93l-8.57 8.57a1.1 1.1 0 01-1.82 0l-.14-.1a1.11 1.11 0 010-1.82L22.09 24l-8.57-8.6a1.09 1.09 0 010-1.82l.09-.1a1.12 1.12 0 011.82 0L24 22.05l8.57-8.57a1.12 1.12 0 011.82 0l.09.1a1.11 1.11 0 010 1.82L25.92 24l8.61 8.61a1.12 1.12 0 010 1.79z"/></svg>'},this.init())}return _createClass(FBQuickNav,[{key:"init",value:function(){this.sectionsEl=document.querySelectorAll(this.settings.section_class+"["+this.settings.section_title+"]"),this.build_html(),this.click_on_quicknav_event(),this.toggle_quicknav_classes(),this.click_on_trigger_event(),this.close_on_scroll(),this.toggle_hide_quicknav(),this.quicknavEl.classList.add("isInit")}},{key:"build_html",value:function(){var quicknavInEl,itemsEl,buttonEl,buttonLabel,buttonIcons,buttonIconOpen,_this=this,buttonIconClose=this.quicknavEl.querySelector(".quickNav__items");void 0!==buttonIconClose&&null!=buttonIconClose||((quicknavInEl=document.createElement("div")).classList.add("quickNav__in"),(itemsEl=document.createElement("div")).classList.add("quickNav__items","jsQuickNav__ctn"),this.sectionsEl.forEach(function(sectionEl,index){var title=sectionEl.getAttribute(_this.settings.section_title),itemEl=document.createElement("a");itemEl.classList.add("quickNav__item"),itemEl.href="#";var spanEl=document.createElement("span");spanEl.classList.add("quickNav__text"),spanEl.textContent=title,itemEl.setAttribute("data-quicknav-index",index),sectionEl.setAttribute("data-quicknav-index",index),itemEl.appendChild(spanEl),itemsEl.appendChild(itemEl)}),quicknavInEl.appendChild(itemsEl),!0===this.settings.add_trigger&&((buttonEl=document.createElement("button")).type="button",buttonEl.classList.add("quickNav__trigger","jsQuickNav__trigger"),(buttonLabel=document.createElement("span")).classList.add("quickNav__triggerLabel","jsQuickNav__triggerLabel"),(buttonIcons=document.createElement("span")).classList.add("quickNav__triggerIcon"),(buttonIconOpen=document.createElement("span")).classList.add("svgIcon","quickNav__triggerOpen"),buttonIconOpen.innerHTML=this.settings.trigger_icon_open,(buttonIconClose=document.createElement("span")).classList.add("svgIcon","quickNav__triggerClose"),buttonIconClose.innerHTML=this.settings.trigger_icon_close,buttonIcons.appendChild(buttonIconOpen),buttonIcons.appendChild(buttonIconClose),buttonEl.appendChild(buttonLabel),buttonEl.appendChild(buttonIcons),this.settings.trigger_after_items?quicknavInEl.appendChild(buttonEl):quicknavInEl.insertBefore(buttonEl,quicknavInEl.firstChild)),this.quicknavEl.appendChild(quicknavInEl),this.linksEL=this.quicknavEl.querySelectorAll("a"),this.set_trigger_label(this.sectionsEl[0]))}},{key:"click_on_trigger_event",value:function(){var _this2=this;!0===this.settings.add_trigger&&this.quicknavEl.querySelector(".jsQuickNav__trigger").addEventListener("click",function(evt){evt.preventDefault(),_this2.quicknavEl.classList.contains("open")?_this2.close_quicknav():_this2.open_quicknav()})}},{key:"set_trigger_label",value:function(sectionName){!0===this.settings.add_trigger&&(sectionName=sectionName.getAttribute("data-quicknav-title"),this.quicknavEl.querySelector(".jsQuickNav__triggerLabel").textContent=sectionName)}},{key:"close_on_scroll",value:function(){var _this3=this;!0===this.settings.add_trigger&&window.addEventListener("scroll",_.throttle(function(){_this3.quicknavEl.classList.contains("open")&&_this3.close_quicknav()},300))}},{key:"open_quicknav",value:function(){this.quicknavEl.classList.add("open")}},{key:"close_quicknav",value:function(){this.quicknavEl.classList.remove("open")}},{key:"click_on_quicknav_event",value:function(){var _this4=this;this.quicknavEl.addEventListener("click",function(evt){var sectionEl=evt.target.closest("a.quickNav__item");sectionEl&&(evt.preventDefault(),sectionEl=sectionEl.getAttribute("data-quicknav-index"),null!=(sectionEl=_this4.find_section_by_index(sectionEl))&&_this4.go_to_section(sectionEl))})}},{key:"find_section_by_index",value:function(searchIndex){var sectionFound=null;return this.sectionsEl.forEach(function(sectionEl){sectionEl.getAttribute("data-quicknav-index")==searchIndex&&(sectionFound=sectionEl)}),sectionFound}},{key:"find_link_by_index",value:function(searchIndex){var linkFound=null;return this.linksEL.forEach(function(linkEl){linkEl.getAttribute("data-quicknav-index")==searchIndex&&(linkFound=linkEl)}),linkFound}},{key:"go_to_section",value:function(y){y=y.getBoundingClientRect().top+window.pageYOffset+this.settings.scroll_offset;window.scrollTo({top:y,behavior:"smooth"})}},{key:"toggle_quicknav_classes",value:function(){var _this5=this;this.sectionsEl.forEach(function(sectionEl){var sectionIndex=sectionEl.getAttribute("data-quicknav-index"),linkEl=_this5.find_link_by_index(sectionIndex);ScrollTrigger.create({trigger:sectionEl,start:"top center",end:"bottom center",onEnter:function(){linkEl.classList.add("active"),_this5.set_trigger_label(sectionEl)},onLeave:function(){linkEl.classList.remove("active")},onEnterBack:function(){linkEl.classList.add("active"),_this5.set_trigger_label(sectionEl)},onLeaveBack:function(){linkEl.classList.remove("active")}})})}},{key:"toggle_hide_quicknav",value:function(){var hideHereEl=document.querySelector(this.settings.section_class_hide);hideHereEl&&ScrollTrigger.create({trigger:hideHereEl,toggleClass:{targets:this.quicknavEl,className:"quickNav--hide"},start:"top 25%",endTrigger:"html",end:"bottom top"})}}]),FBQuickNav}();