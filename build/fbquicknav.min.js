"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}var FBQuickNav=function(){function FBQuickNav(selector,options){_classCallCheck(this,FBQuickNav),this.quicknavEl=document.querySelector(selector),null!=this.quicknavEl&&void 0!==this.quicknavEl&&(this.settings={sectionClass:".jsQuickNav__section",sectionTitle:"data-quicknav-title",section_ClassHide:".jsQuickNav__hide",scrollOffset:-100,addTrigger:!1,triggerAfterItems:!1,triggerIconOpen:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M50 79.53L2.5 32.03l11.56-11.56L50 56.41l35.94-35.94L97.5 32.03z"/></svg>',triggerIconClose:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M1.004 89.605l88.6-88.6 9.397 9.397-88.6 88.6z"/><path d="M1.004 10.394L10.402.997l88.6 88.6-9.398 9.397z"/></svg>'},this.settings=Object.assign(this.settings,options),this.nodesEls=[],this.nodesEls.sections=[],this.nodesEls.links=[],this.nodesEls.titles=[],this.init())}return _createClass(FBQuickNav,[{key:"init",value:function(){this.getSections(),this.buildHTML(),this.clickItemsEvents(),this.scrollActivateItems(),this.triggerEvents(),this.closeOnScroll(),this.hideQuickNav(),this.quicknavEl.classList.add("isInit")}},{key:"getSections",value:function(){var _this=this;document.querySelectorAll("".concat(this.settings.sectionClass,"[").concat(this.settings.sectionTitle,"]")).forEach(function(sectionTitle,index){sectionTitle=(_this.nodesEls.sections[index]=sectionTitle).getAttribute("data-quicknav-title");_this.nodesEls.titles[index]=sectionTitle})}},{key:"buildHTML",value:function(){var _this2=this,quicknavInEl=document.createElement("div");quicknavInEl.classList.add("quickNav__in");var buttonEl,buttonLabel,buttonIcons,buttonIconOpen,buttonIconClose,itemsEl=document.createElement("div");itemsEl.classList.add("quickNav__items","jsQuickNav__ctn"),this.nodesEls.sections.forEach(function(spanEl,index){var title=spanEl.getAttribute(_this2.settings.sectionTitle),itemEl=document.createElement("a");itemEl.classList.add("quickNav__item"),itemEl.href="#";spanEl=document.createElement("span");spanEl.classList.add("quickNav__text"),spanEl.textContent=title,(_this2.nodesEls.links[index]=itemEl).appendChild(spanEl),itemsEl.appendChild(itemEl)}),quicknavInEl.appendChild(itemsEl),!0===this.settings.addTrigger&&((buttonEl=document.createElement("button")).type="button",buttonEl.classList.add("quickNav__trigger","jsQuickNav__trigger"),(buttonLabel=document.createElement("span")).classList.add("quickNav__triggerLabel","jsQuickNav__triggerLabel"),(buttonIcons=document.createElement("span")).classList.add("quickNav__triggerIcon"),(buttonIconOpen=document.createElement("span")).classList.add("svgIcon","quickNav__triggerOpen"),buttonIconOpen.innerHTML=this.settings.triggerIconOpen,(buttonIconClose=document.createElement("span")).classList.add("svgIcon","quickNav__triggerClose"),buttonIconClose.innerHTML=this.settings.triggerIconClose,buttonIcons.appendChild(buttonIconOpen),buttonIcons.appendChild(buttonIconClose),buttonEl.appendChild(buttonLabel),buttonEl.appendChild(buttonIcons),this.settings.triggerAfterItems?quicknavInEl.appendChild(buttonEl):quicknavInEl.insertBefore(buttonEl,quicknavInEl.firstChild)),this.quicknavEl.appendChild(quicknavInEl),this.setTriggerLabel(0)}},{key:"clickItemsEvents",value:function(){var _this3=this;this.nodesEls.links.forEach(function(linkEl,index){linkEl.addEventListener("click",function(evt){evt.preventDefault(),_this3.goToSection(_this3.nodesEls.sections[index])})})}},{key:"scrollActivateItems",value:function(){var _this4=this;this.nodesEls.sections.forEach(function(sectionEl,index){var linkEl=_this4.nodesEls.links[index];ScrollTrigger.create({trigger:sectionEl,start:"top center",end:"bottom center",onEnter:function(){linkEl.classList.add("active"),_this4.setTriggerLabel(index)},onLeave:function(){linkEl.classList.remove("active")},onEnterBack:function(){linkEl.classList.add("active"),_this4.setTriggerLabel(index)},onLeaveBack:function(){linkEl.classList.remove("active")}})})}},{key:"triggerEvents",value:function(){var triggerEl,_this5=this;!0!==this.settings.addTrigger||(triggerEl=this.quicknavEl.querySelector(".jsQuickNav__trigger"))&&triggerEl.addEventListener("click",function(evt){evt.preventDefault(),_this5.quicknavEl.classList.contains("open")?_this5.closeQuicknav():_this5.openQuicknav()})}},{key:"closeOnScroll",value:function(){var _this6=this;!0===this.settings.addTrigger&&window.addEventListener("scroll",_.throttle(function(){_this6.quicknavEl.classList.contains("open")&&_this6.closeQuicknav()},300))}},{key:"hideQuickNav",value:function(){var hideHereEl=document.querySelector(this.settings.sectionClassHide);hideHereEl&&ScrollTrigger.create({trigger:hideHereEl,toggleClass:{targets:this.quicknavEl,className:"quickNav--hide"},start:"top 25%",endTrigger:"html",end:"bottom top"})}},{key:"setTriggerLabel",value:function(index){!0===this.settings.addTrigger&&(this.triggerLabelEl||(this.triggerLabelEl=this.quicknavEl.querySelector(".jsQuickNav__triggerLabel")),this.triggerLabelEl&&(this.triggerLabelEl.textContent=this.nodesEls.titles[index]))}},{key:"openQuicknav",value:function(){this.quicknavEl.classList.add("open")}},{key:"closeQuicknav",value:function(){this.quicknavEl.classList.remove("open")}},{key:"goToSection",value:function(y){y=y.getBoundingClientRect().top+window.pageYOffset+this.settings.scrollOffset;window.scrollTo({top:y,behavior:"smooth"})}}]),FBQuickNav}();