"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}var FBQuickNav=function(){function FBQuickNav(selector,options){_classCallCheck(this,FBQuickNav),this.selector=selector,this.quicknavEl=document.querySelector(this.selector),null!=this.quicknavEl&&void 0!==this.quicknavEl&&(this.settings={section_class:".jsQuickNav__section",section_title:"data-quicknav-title",section_class_hide:".jsQuickNav__hide",scroll_offset:-120,add_trigger:!0,trigger_after_items:!1,trigger_icon_open:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M50 79.53L2.5 32.03l11.56-11.56L50 56.41l35.94-35.94L97.5 32.03z"/></svg>',trigger_icon_close:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M1.004 89.605l88.6-88.6 9.397 9.397-88.6 88.6z"/><path d="M1.004 10.394L10.402.997l88.6 88.6-9.398 9.397z"/></svg>'},this.settings=Object.assign(this.settings,options),this.init())}return _createClass(FBQuickNav,[{key:"init",value:function(){this.sectionsEl=document.querySelectorAll(this.settings.section_class+"["+this.settings.section_title+"]"),this.build_html(),this.click_items_events(),this.scroll_activate_items(),this.open_close_trigger(),this.close_on_scroll(),this.hide_quicknav(),this.quicknavEl.classList.add("isInit")}},{key:"build_html",value:function(){var quicknavInEl,itemsEl,buttonEl,buttonLabel,buttonIcons,buttonIconOpen,_this=this,buttonIconClose=this.quicknavEl.querySelector(".quickNav__items");void 0!==buttonIconClose&&null!=buttonIconClose||((quicknavInEl=document.createElement("div")).classList.add("quickNav__in"),(itemsEl=document.createElement("div")).classList.add("quickNav__items","jsQuickNav__ctn"),this.sectionsEl.forEach(function(sectionEl,index){var title=sectionEl.getAttribute(_this.settings.section_title),itemEl=document.createElement("a");itemEl.classList.add("quickNav__item"),itemEl.href="#";var spanEl=document.createElement("span");spanEl.classList.add("quickNav__text"),spanEl.textContent=title,itemEl.setAttribute("data-quicknav-index",index),sectionEl.setAttribute("data-quicknav-index",index),itemEl.appendChild(spanEl),itemsEl.appendChild(itemEl)}),quicknavInEl.appendChild(itemsEl),!0===this.settings.add_trigger&&((buttonEl=document.createElement("button")).type="button",buttonEl.classList.add("quickNav__trigger","jsQuickNav__trigger"),(buttonLabel=document.createElement("span")).classList.add("quickNav__triggerLabel","jsQuickNav__triggerLabel"),(buttonIcons=document.createElement("span")).classList.add("quickNav__triggerIcon"),(buttonIconOpen=document.createElement("span")).classList.add("svgIcon","quickNav__triggerOpen"),buttonIconOpen.innerHTML=this.settings.trigger_icon_open,(buttonIconClose=document.createElement("span")).classList.add("svgIcon","quickNav__triggerClose"),buttonIconClose.innerHTML=this.settings.trigger_icon_close,buttonIcons.appendChild(buttonIconOpen),buttonIcons.appendChild(buttonIconClose),buttonEl.appendChild(buttonLabel),buttonEl.appendChild(buttonIcons),this.settings.trigger_after_items?quicknavInEl.appendChild(buttonEl):quicknavInEl.insertBefore(buttonEl,quicknavInEl.firstChild)),this.quicknavEl.appendChild(quicknavInEl),this.linksEL=this.quicknavEl.querySelectorAll("a"),this.set_trigger_label(this.sectionsEl[0]))}},{key:"click_items_events",value:function(){var _this2=this;this.quicknavEl.addEventListener("click",function(evt){var sectionEl=evt.target.closest("a.quickNav__item");sectionEl&&(evt.preventDefault(),sectionEl=sectionEl.getAttribute("data-quicknav-index"),null!=(sectionEl=_this2.find_section_by_index(sectionEl))&&_this2.go_to_section(sectionEl))})}},{key:"scroll_activate_items",value:function(){var _this3=this;this.sectionsEl.forEach(function(sectionEl){var sectionIndex=sectionEl.getAttribute("data-quicknav-index"),linkEl=_this3.find_link_by_index(sectionIndex);ScrollTrigger.create({trigger:sectionEl,start:"top center",end:"bottom center",onEnter:function(){linkEl.classList.add("active"),_this3.set_trigger_label(sectionEl)},onLeave:function(){linkEl.classList.remove("active")},onEnterBack:function(){linkEl.classList.add("active"),_this3.set_trigger_label(sectionEl)},onLeaveBack:function(){linkEl.classList.remove("active")}})})}},{key:"open_close_trigger",value:function(){var _this4=this;!0===this.settings.add_trigger&&this.quicknavEl.querySelector(".jsQuickNav__trigger").addEventListener("click",function(evt){evt.preventDefault(),_this4.quicknavEl.classList.contains("open")?_this4.close_quicknav():_this4.open_quicknav()})}},{key:"close_on_scroll",value:function(){var _this5=this;!0===this.settings.add_trigger&&window.addEventListener("scroll",_.throttle(function(){_this5.quicknavEl.classList.contains("open")&&_this5.close_quicknav()},300))}},{key:"hide_quicknav",value:function(){var hideHereEl=document.querySelector(this.settings.section_class_hide);hideHereEl&&ScrollTrigger.create({trigger:hideHereEl,toggleClass:{targets:this.quicknavEl,className:"quickNav--hide"},start:"top 25%",endTrigger:"html",end:"bottom top"})}},{key:"set_trigger_label",value:function(sectionName){!0===this.settings.add_trigger&&(sectionName=sectionName.getAttribute("data-quicknav-title"),this.quicknavEl.querySelector(".jsQuickNav__triggerLabel").textContent=sectionName)}},{key:"open_quicknav",value:function(){this.quicknavEl.classList.add("open")}},{key:"close_quicknav",value:function(){this.quicknavEl.classList.remove("open")}},{key:"find_section_by_index",value:function(searchIndex){var sectionFound=null;return this.sectionsEl.forEach(function(sectionEl){sectionEl.getAttribute("data-quicknav-index")==searchIndex&&(sectionFound=sectionEl)}),sectionFound}},{key:"find_link_by_index",value:function(searchIndex){var linkFound=null;return this.linksEL.forEach(function(linkEl){linkEl.getAttribute("data-quicknav-index")==searchIndex&&(linkFound=linkEl)}),linkFound}},{key:"go_to_section",value:function(y){y=y.getBoundingClientRect().top+window.pageYOffset+this.settings.scroll_offset;window.scrollTo({top:y,behavior:"smooth"})}}]),FBQuickNav}();